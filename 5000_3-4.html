<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio English Flashcards</title>
    <style>
        :root {
            --primary-color: #4CAF50; /* Biology Green */
            --accent-color: #2E7D32;
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-main: #333;
            --text-sub: #666;
            --shadow: 0 10px 25px rgba(0,0,0,0.1);
            --btn-ok: #4CAF50;
            --btn-ng: #FF9800;
            --font-main: 'Helvetica Neue', Arial, sans-serif;
        }

        * { box-sizing: border-box; touch-action: manipulation; }
        
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            color: var(--text-main);
        }

        /* Container */
        .app-container {
            width: 100%;
            max-width: 400px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh; /* Full viewport height */
            max-height: 800px;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            margin-bottom: 15px;
            text-align: center;
        }
        .progress-text {
            font-size: 0.9rem;
            color: var(--text-sub);
            margin-bottom: 5px;
            font-weight: bold;
        }
        .progress-bar-bg {
            width: 100%;
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background: var(--primary-color);
            width: 0%; /* JS„ÅßÂà∂Âæ° */
            transition: width 0.3s ease;
        }

        /* Card Scene */
        .scene {
            width: 100%;
            flex-grow: 1; /* ÊÆã„Çä„ÅÆ„Çπ„Éö„Éº„Çπ„ÇíÂüã„ÇÅ„Çã */
            perspective: 1000px;
            position: relative;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
            transform-style: preserve-3d;
            border-radius: 20px;
            box-shadow: var(--shadow);
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden; /* Safari fix */
            border-radius: 20px;
            background: var(--card-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        /* Front Face */
        .card-front {
            z-index: 2;
        }
        .word {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: var(--text-main);
            text-align: center;
        }
        .phonetic {
            font-size: 1.2rem;
            color: var(--text-sub);
            font-family: 'Times New Roman', serif;
            margin-bottom: 30px;
        }
        .speaker-btn {
            background: #e8f5e9;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary-color);
            transition: transform 0.1s, background 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .speaker-btn:active {
            transform: scale(0.95);
        }
        .speaker-btn:hover {
            background: #c8e6c9;
        }

        /* Back Face */
        .card-back {
            transform: rotateY(180deg);
            justify-content: flex-start; /* Èï∑ÊñáÂØæÁ≠ñÔºö‰∏äË©∞„ÇÅ */
            overflow-y: auto; /* „Çπ„ÇØ„É≠„Éº„É´Ë®±ÂèØ */
        }
        .translation {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 20px;
            margin-top: auto; /* ÂûÇÁõ¥‰∏≠Â§ÆÂØÑ„Åõ„ÅÆË£úÂä© */
            text-align: center;
        }
        .meaning-box {
            background: #fff8e1;
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            margin-bottom: auto; /* ÂûÇÁõ¥‰∏≠Â§ÆÂØÑ„Åõ„ÅÆË£úÂä© */
            border-left: 5px solid #ffc107;
        }
        .meaning-title {
            font-size: 0.8rem;
            color: #ff8f00;
            font-weight: bold;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .meaning-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }
        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÅÆË£ÖÈ£æÔºàWebkitÔºâ */
        .card-back::-webkit-scrollbar {
            width: 6px;
        }
        .card-back::-webkit-scrollbar-thumb {
            background-color: rgba(0,0,0,0.2);
            border-radius: 3px;
        }

        /* Controls */
        .controls {
            width: 100%;
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }
        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn:active { transform: translateY(2px); box-shadow: 0 2px 3px rgba(0,0,0,0.15); }
        .btn-ng { background-color: var(--btn-ng); }
        .btn-ok { background-color: var(--btn-ok); }

        /* Completion Screen */
        .completion-screen {
            text-align: center;
            display: none;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }
        .completion-title {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        .completion-emoji {
            font-size: 5rem;
            margin-bottom: 30px;
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        /* Helper */
        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="app-container">
    
    <!-- Progress Header -->
    <div class="progress-container" id="progressContainer">
        <div class="progress-text">ÊÆã„ÇäÂçòË™ûÊï∞: <span id="remainingCount">0</span></div>
        <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="progressBar"></div>
        </div>
    </div>

    <!-- Main Card Area -->
    <div class="scene" id="cardScene">
        <div class="card" id="card">
            <!-- Front -->
            <div class="card-face card-front">
                <div class="word" id="wordDisplay">Loading...</div>
                <div class="phonetic" id="phoneticDisplay"></div>
                <button class="speaker-btn" id="speakerBtn" title="Èü≥Â£∞ÂÜçÁîü">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                    </svg>
                </button>
            </div>
            <!-- Back -->
            <div class="card-face card-back">
                <div class="translation" id="translationDisplay"></div>
                <div class="meaning-box">
                    <div class="meaning-title">ÂÖàÁîü„ÅÆ„Å≤„Å®„Åì„Å®Ëß£Ë™¨</div>
                    <div class="meaning-text" id="meaningDisplay"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Completion Screen -->
    <div class="completion-screen" id="completionScreen">
        <div class="completion-emoji">üéâ</div>
        <div class="completion-title">Complete!</div>
        <p>„Åô„Åπ„Å¶„ÅÆÂçòË™û„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åó„Åü„ÄÇ<br>Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅ</p>
        <button class="btn btn-ok" onclick="location.reload()" style="margin-top: 20px;">
            „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÊúÄÂàù„Åã„Çâ
        </button>
    </div>

    <!-- Controls -->
    <div class="controls" id="controls">
        <button class="btn btn-ng" id="btnNg">
            <span>üîÑ</span> Ëã¶Êâã / „Åæ„Å†
        </button>
        <button class="btn btn-ok" id="btnOk">
            <span>‚úÖ</span> Ë¶ö„Åà„ÅüÔºÅ
        </button>
    </div>

</div>

<script>
    /* =========================================
       1. Vocabulary Data (Extracted & Enhanced)
       ========================================= */
    const rawData = [
        // Image 1: Basic Botany
        { word: "botany", phonetic: "[b…ëÃÅt…ôni]", translation: "Ê§çÁâ©Â≠¶", meaning: "Ê§çÁâ©ÂÖ®Ëà¨„Å´„Å§„ÅÑ„Å¶Á†îÁ©∂„Åô„ÇãÂ≠¶Âïè„ÅÆ„Åì„Å®„ÄÇ„ÄåBotanic GardenÔºàÊ§çÁâ©ÂúíÔºâ„Äç„Å®„ÅÑ„ÅÜË®ÄËëâ„Åß„ÇÇ„Çà„Åè‰Ωø„Çè„Çå„Åæ„Åô„ÄÇ" },
        { word: "spore", phonetic: "[sp…îÀêr]", translation: "ËÉûÂ≠ê", meaning: "„Ç≠„Éé„Ç≥„ÇÑ„Ç∑„ÉÄÊ§çÁâ©„Åå‰ª≤Èñì„ÇíÂ¢ó„ÇÑ„Åô„Åü„ÇÅ„ÅÆ„ÄåÁ®ÆÔºà„Çø„ÉçÔºâ„Äç„Åø„Åü„ÅÑ„Å™„ÇÇ„ÅÆ„ÄÇÈ¢®„Å´‰πó„Å£„Å¶ÈÅ†„Åè„Åæ„ÅßÈ£õ„Çì„Åß„ÅÑ„Åç„Åæ„Åô„ÄÇ" },
        { word: "germination", phonetic: "[d í…ôÀêrm…ôn√©i É…ôn]", translation: "Áô∫ËäΩ", meaning: "Áú†„Å£„Å¶„ÅÑ„ÅüÁ®Æ„ÅåÁõÆ„ÇíË¶ö„Åæ„Åó„Å¶„ÄÅËäΩ„Çí„Éã„Éß„Ç≠„ÉÉ„Å®Âá∫„ÅôÁû¨Èñì„ÅÆ„Åì„Å®„ÄÇÊ§çÁâ©„ÅÆ„ÄåË™ïÁîü„Äç„Åß„Åô„ÄÇ" },
        { word: "pollen", phonetic: "[p…ëÃÅl…ôn]", translation: "Ëä±Á≤â", meaning: "Ëä±Á≤âÁóá„ÅÆÂéüÂõ†„Å®„Åó„Å¶„ÇÇÊúâÂêç„Åß„Åô„Åå„ÄÅÊú¨Êù•„ÅØÊ§çÁâ©„ÅåÂ≠êÂ≠´„ÇíÊÆã„Åô„Åü„ÇÅ„ÅÆÂ§ßÂàá„Å™Á≤â„ÄÇËô´„ÇÑÈ¢®„Å´ÈÅã„Çì„Åß„ÇÇ„Çâ„ÅÑ„Åæ„Åô„ÄÇ" },
        { word: "photosynthesis", phonetic: "[f√≤utous√≠nŒ∏…ôsis]", translation: "ÂÖâÂêàÊàê", meaning: "Ê§çÁâ©„ÅåÂ§™ÈôΩ„ÅÆÂÖâ„Çí„Ç®„Éç„É´„ÇÆ„Éº„Å´Â§â„Åà„Å¶„ÄÅËá™ÂàÜ„Åß„ÅîÈ£ØÔºàÊ†ÑÈ§äÔºâ„Çí‰Ωú„Çã„Åô„Åî„ÅÑ‰ªïÁµÑ„Åø„ÅÆ„Åì„Å®„ÄÇ" },
        { word: "chlorophyll", phonetic: "[kl…îÃÅÀêr…ôf√¨l]", translation: "ËëâÁ∑ëÁ¥†", meaning: "Ê§çÁâ©„ÅÆË°ÄÊ∂≤„Åø„Åü„ÅÑ„Å™„ÇÇ„ÅÆ„ÄÇ„Åì„Çå„Åå„ÅÇ„Çã„Åã„ÇâËëâ„Å£„Å±„ÅØÁ∑ëËâ≤„Å†„Åó„ÄÅÂ§™ÈôΩ„ÇíÈ£ü„ÅπÁâ©„Å´Â§âÊèõ„Åß„Åç„Çã„Çì„Åß„Åô„ÄÇ" },
        { word: "cellulose", phonetic: "[s√©ljul√≤us]", translation: "„Çª„É´„É≠„Éº„Çπ", meaning: "Ê§çÁâ©„ÅÆ‰Ωì„ÇíÊîØ„Åà„Çã„ÄåÈ™®ÁµÑ„Åø„Äç„Å´„Å™„ÇãÊàêÂàÜ„ÄÇÁ¥ô„ÅÆÂéüÊñô„Å´„Å™„Å£„Åü„Çä„ÄÅÈ£üÁâ©ÁπäÁ∂≠„Å®„Åó„Å¶„ÅäËÖπ„ÅÆÊéÉÈô§„ÇÇ„Åó„Å¶„Åè„Çå„Åæ„Åô„ÄÇ" },
        { word: "stem", phonetic: "[stem]", translation: "ËåéÔºà„Åè„ÅçÔºâ / Âππ", meaning: "Ê§çÁâ©„ÅÆËÉåÈ™®„ÄÇÊ†π„Å£„Åì„Åã„ÇâÂê∏„Å£„ÅüÊ∞¥„ÇíËëâ„Å£„Å±„Å∏Â±ä„Åë„Çã„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÂΩπÂâ≤„ÇÇ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
        { word: "petal", phonetic: "[p√©tl]", translation: "Ëä±„Å≥„Çâ", meaning: "Ëä±„ÅÆ‰∏≠„Åß‰∏ÄÁï™„Ç´„É©„Éï„É´„Å™ÈÉ®ÂàÜ„ÄÇËô´„Åü„Å°„Å´„Äå„Åì„Åì„Å´ÁæéÂë≥„Åó„ÅÑËúú„Åå„ÅÇ„Çã„ÇàÔºÅ„Äç„Å®ÁúãÊùø„ÇíÂá∫„Åó„Å¶Âëº„Çì„Åß„ÅÑ„Çã„Çì„Åß„Åô„ÄÇ" },
        { word: "stoma", phonetic: "[st√≥um…ô]", translation: "Ê∞óÂ≠î", meaning: "Ëëâ„Å£„Å±„ÅÆË£è„Å´„ÅÇ„ÇãÂ∞è„Åï„Å™„ÄåÂè£„Äç„ÄÇ„Åì„Åì„ÇíÈñã„ÅëÈñâ„ÇÅ„Åó„Å¶„ÄÅÂëºÂê∏„Åó„Åü„ÇäÊ∞¥ÂàÜË™øÊï¥„Çí„Åó„Åü„Çä„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÔºàË§áÊï∞ÂΩ¢„ÅØ stomataÔºâ" },
        { word: "vein", phonetic: "[vein]", translation: "ËëâËÑà", meaning: "Ëëâ„Å£„Å±„Å´Ë¶ã„Åà„ÇãÁ∂≤ÁõÆÁä∂„ÅÆÁ≠ã„ÅÆ„Åì„Å®„ÄÇ‰∫∫Èñì„Åß„ÅÑ„ÅÜË°ÄÁÆ°„Åß„ÄÅÊ∞¥„ÇÑÊ†ÑÈ§ä„ÇíÈöÖ„ÄÖ„Åæ„ÅßÈÅã„Å≥„Åæ„Åô„ÄÇ" },
        { word: "taproot", phonetic: "[t«Ωpr√πÀêt]", translation: "‰∏ªÊ†π", meaning: "Â§ßÊ†π„ÇÑ„Éã„É≥„Ç∏„É≥„ÅÆ„Çà„ÅÜ„Å´„ÄÅÂú∞Èù¢„ÅÆÂ••Ê∑±„Åè„Å∏„Ç∫„Éâ„Éº„É≥„Å®‰º∏„Å≥„ÇãÂ§™„ÅÑ„É°„Ç§„É≥„ÅÆÊ†π„Å£„Åì„ÅÆ„Åì„Å®„ÄÇ" },
        { word: "perennial", phonetic: "[p…ôr√©ni…ôl]", translation: "Â§öÂπ¥ÁîüÊ§çÁâ©", meaning: "‰∏ÄÂ∫¶Ê§ç„Åà„Åü„Çâ‰ΩïÂπ¥„ÇÇÁîü„ÅçÁ∂ö„Åë„ÇãÊ§çÁâ©„ÄÇÊØéÂπ¥Á®Æ„Çí„Åæ„Åã„Å™„Åè„Å¶„ÇÇ„ÄÅÂ≠£ÁØÄ„ÅåÊù•„Çå„Å∞„Åæ„ÅüËä±„ÇíÂí≤„Åã„Åõ„Åæ„Åô„ÄÇ" },
        { word: "annual", phonetic: "[«Ωnju…ôl]", translation: "‰∏ÄÂπ¥ÁîüÊ§çÁâ©", meaning: "1Âπ¥‰ª•ÂÜÖ„Å´Áô∫ËäΩ„Åó„Å¶„ÄÅËä±„ÇíÂí≤„Åã„Åõ„ÄÅÊûØ„Çå„Å¶„ÅÑ„ÅèÊ§çÁâ©„ÄÇ„Äå‰∏ÄÁîü„Åå1Âπ¥„ÅßÂÆåÁµê„Åô„Çã„Äç„Çø„Ç§„Éó„Åß„Åô„ÄÇ" },

        // Image 2: Forests & Ecology
        { word: "biennial", phonetic: "[bai√©ni…ôl]", translation: "‰∫åÂπ¥ÁîüÊ§çÁâ©", meaning: "2Âπ¥„Åã„Åë„Å¶‰∏ÄÁîü„ÇíÁµÇ„Åà„ÇãÊ§çÁâ©„ÄÇ1Âπ¥ÁõÆ„ÅØ‰Ωì„ÇíÂ§ß„Åç„Åè„Åó„Å¶„ÄÅ2Âπ¥ÁõÆ„Å´Ëä±„ÇíÂí≤„Åã„Åõ„Å¶ÊûØ„Çå„Åæ„Åô„ÄÇ" },
        { word: "vegetation", phonetic: "[v√®d í…ôt√©i É…ôn]", translation: "Ê§çÁîü / Ê§çÁâ©", meaning: "„ÅÇ„ÇãÂ†¥ÊâÄ„Å´Áîü„Åà„Å¶„ÅÑ„ÇãÊ§çÁâ©ÂÖ®‰Ωì„ÅÆ„Åì„Å®„ÄÇ„Äå„ÅÇ„Åù„Åì„ÅÆÂ±±„ÅÆvegetation„ÅØË±ä„Åã„Å†„Å≠„Äç„Åø„Åü„ÅÑ„Å´‰Ωø„ÅÑ„Åæ„Åô„ÄÇ" },
        { word: "scrubland", phonetic: "[skr åÃÅbl√¶nd]", translation: "‰ΩéÊú®Âú∞", meaning: "ËÉå„ÅÆ‰Ωé„ÅÑÊú®Ôºà‰ΩéÊú®Ôºâ„Å∞„Åã„Çä„ÅåÁîü„Åà„Å¶„ÅÑ„ÇãÂúüÂú∞„ÄÇ„ÅÇ„Åæ„ÇäÈõ®„ÅåÈôç„Çâ„Å™„ÅÑÂ†¥ÊâÄ„Å´„Çà„Åè„ÅÇ„Çä„Åæ„Åô„ÄÇ" },
        { word: "canopy", phonetic: "[k«Ωn…ôpi]", translation: "Ê®πÂÜ†Ôºà„Åò„ÇÖ„Åã„ÇìÔºâ", meaning: "Ê£Æ„ÅÆ‰∏ä„ÅÆÊñπ„Åß„ÄÅÊú®„ÅÆÊûù„ÇÑËëâ„Å£„Å±„ÅåÂ±ãÊ†π„ÅÆ„Çà„ÅÜ„Å´Ë¶Ü„ÅÑË¢´„Åï„Å£„Å¶„ÅÑ„ÇãÈÉ®ÂàÜ„ÄÇ„Ç∏„É£„É≥„Ç∞„É´„ÅÆÂ§©‰∫ï„Åß„Åô„ÄÇ" },
        { word: "deciduous", phonetic: "[dis√≠d íu…ôs]", translation: "ËêΩËëâÊÄß„ÅÆ", meaning: "ÂÜ¨„Å´„Å™„Çã„Å®„ÄåÂØí„ÅÑ„Åã„Çâ‰∏ÄÊó¶Â∫ó„Åò„Åæ„ÅÑÔºÅ„Äç„Å®„ÅÑ„Å£„Å¶„ÄÅËëâ„Å£„Å±„ÇíÂÖ®ÈÉ®ËêΩ„Å®„Åó„Å¶„Éè„Ç≤„Å°„ÇÉ„ÅÜÊú®„ÅÆ„Åì„Å®„ÄÇ" },
        { word: "shade-tolerant", phonetic: "[ É√©id-t…ëÃÅl…ôr…ônt]", translation: "ËÄêÈô∞ÊÄß„ÅÆ„ÅÇ„Çã", meaning: "Êó•Èô∞„Åß„ÇÇ„Å∏„Å£„Å°„ÇÉ„Çâ„Å™Ê§çÁâ©„ÄÇÂ§ß„Åç„Å™Êú®„ÅÆ‰∏ã„ÅÆ„Çà„ÅÜ„Å™Êöó„ÅÑÂ†¥ÊâÄ„Åß„ÇÇÊñáÂè•„ÇíË®Ä„Çè„Åö„Å´ËÇ≤„Å°„Åæ„Åô„ÄÇ" },
        { word: "conifer", phonetic: "[k…ëÃÅn…ôf…ôr]", translation: "ÈáùËëâÊ®π", meaning: "„Éû„ÉÑ„ÇÑ„Çπ„ÇÆ„ÅÆ„Çà„ÅÜ„Å´„ÄÅËëâ„Å£„Å±„ÅåÈáù„Åø„Åü„ÅÑ„Å´Â∞ñ„Å£„Å¶„ÅÑ„ÇãÊú®„ÄÇ„ÇØ„É™„Çπ„Éû„Çπ„ÉÑ„É™„Éº„ÅØÂ§ß‰Ωì„Åì„Çå„Åß„Åô„ÄÇ" },
        { word: "insectivorous plant", phonetic: "[ins√®kt√≠v…ôr…ôs pl«Ωnt]", translation: "È£üËô´Ê§çÁâ©", meaning: "Ëô´„ÇíÊçï„Åæ„Åà„Å¶È£ü„Åπ„ÇãÊ§çÁâ©„ÄÇÂúü„Åã„Çâ„ÅÆÊ†ÑÈ§ä„Å†„Åë„Åò„ÇÉË∂≥„Çä„Å™„ÅÑ„Åã„Çâ„ÄÅ„ÅäËÇâ„ÇÇÈ£ü„Åπ„Çã„Çì„Åß„Åô„ÄÇ" },
        { word: "alga", phonetic: "[«Ωlg…ô]", translation: "ËóªÔºà„ÇÇÔºâ", meaning: "Ê∞¥„ÅÆ‰∏≠„Å´‰Ωè„Çì„Åß„ÅÑ„ÇãÊ§çÁâ©„ÅÆ„Çà„ÅÜ„Å™Áîü„ÅçÁâ©„ÄÇ„ÉØ„Ç´„É°„ÇÑ„Ç≥„É≥„Éñ„ÅÆ‰ª≤Èñì„ÄÇÔºàË§áÊï∞ÂΩ¢„ÅØ algaeÔºâ" },
        { word: "arboreal", phonetic: "[…ëÀêrb…îÃÅÀêri…ôl]", translation: "Ê®π‰∏ä„ÅÆ / Êú®„Å´‰Ωè„ÇÄ", meaning: "Âú∞Èù¢„Åß„ÅØ„Å™„Åè„ÄÅÊú®„ÅÆ‰∏ä„ÅßÁîüÊ¥ª„Åô„Çã„Åì„Å®„ÄÇ„Äå„Ç≥„Ç¢„É©„ÅØarboreal animalÔºàÊ®π‰∏äÂãïÁâ©Ôºâ„Å†„Å≠„Äç„ÅÆ„Çà„ÅÜ„Å´‰Ωø„ÅÑ„Åæ„Åô„ÄÇ" },

        // Image 3: Insects I
        { word: "metamorphosis", phonetic: "[m√®t…ôm…îÃÅÀêrf…ôsis]", translation: "Â§âÊÖã", meaning: "ÂäáÁöÑ„Éì„Éï„Ç©„Éº„Ç¢„Éï„Çø„Éº„ÄÇËäãËô´„ÅåËù∂„Å´„Å™„Çã„Çà„ÅÜ„Å™„ÄÅÊàêÈï∑„Åó„Å¶ÂÆåÂÖ®„Å´Âßø„ÅåÂ§â„Çè„ÇãÂ§âË∫´„ÅÆ„Åì„Å®„ÄÇ" },
        { word: "larva", phonetic: "[l…ëÃÅÀêrv…ô]", translation: "ÂπºËô´", meaning: "ÊòÜËô´„ÅÆÂ≠ê‰æõÊôÇ‰ª£„ÄÇËù∂„Åß„ÅÑ„ÅÜ„Äå„Ç¢„Ç™„É†„Ç∑„Äç„ÅÆÁä∂ÊÖã„ÄÇÔºàË§áÊï∞ÂΩ¢„ÅØ larvaeÔºâ" },
        { word: "pupa", phonetic: "[pj√∫Àêp…ô]", translation: "„Åï„Å™„Åé", meaning: "ÂπºËô´„ÅåÂ§ß‰∫∫ÔºàÊàêËô´Ôºâ„Å´„Å™„Çã„Åü„ÇÅ„ÅÆÊ∫ñÂÇôÊúüÈñì„ÄÇÂãï„Åã„Å™„ÅÑ„Åë„Å©„ÄÅ‰∏≠„Åß„ÅØ‰Ωì„Åå‰Ωú„ÇäÂ§â„Åà„Çâ„Çå„ÇãÂ§ßÂ∑•‰∫ã‰∏≠„Åß„Åô„ÄÇ" },
        { word: "cocoon", phonetic: "[k…ôk√∫Àên]", translation: "Áπ≠Ôºà„Åæ„ÇÜÔºâ", meaning: "„Åï„Å™„Åé„ÅåËá™ÂàÜ„ÇíÂÆà„Çã„Åü„ÇÅ„Å´‰Ωú„Çã„Ç∑„É´„ÇØ„ÅÆÂØùË¢ã„ÄÇ„Ç∑„É´„ÇØÔºàÁµπÔºâ„ÅØ„Åì„ÅÆÁπ≠„Åã„ÇâÂèñ„Çä„Åæ„Åô„ÄÇ" },
        { word: "ecdysis", phonetic: "[√©kd…ôsis]", translation: "ËÑ±ÁöÆ", meaning: "‰Ωì„ÅåÂ§ß„Åç„Åè„Å™„Å£„Å¶Êúç„Åå„Åç„Å§„Åè„Å™„Å£„Åü„Åã„Çâ„ÄÅÂè§„ÅÑÁöÆ„ÇíËÑ±„ÅéÊç®„Å¶„Çã„Åì„Å®„ÄÇËÑ±„Åê„Å®„Å≤„Å®Âõû„ÇäÂ§ß„Åç„Åè„Å™„Çä„Åæ„Åô„ÄÇ" },
        { word: "mimicry", phonetic: "[m√≠mikri]", translation: "Êì¨ÊÖãÔºà„Åé„Åü„ÅÑÔºâ", meaning: "‰ªñ„ÅÆÂº∑„ÅÑÁîü„ÅçÁâ©„ÇÑ„ÄÅÂë®„Çä„ÅÆÈ¢®ÊôØ„ÅÆ„É¢„Éé„Éû„Éç„Çí„Åó„Å¶Ë∫´„ÇíÂÆà„Çã„Åì„Å®„ÄÇ„ÄåÁßÅ„ÄÅÁæéÂë≥„Åó„ÅÑËô´„Åò„ÇÉ„Å™„ÅÑ„Åß„Åô„Çà„Äú„Äç„Å®„ÅÑ„ÅÜÊºîÊäÄ„ÄÇ" },
        { word: "camouflage", phonetic: "[k«Ωm…ôfl…ëÃÄÀê í]", translation: "„Ç´„É¢„Éï„É©„Éº„Ç∏„É• / ‰øùË≠∑Ëâ≤", meaning: "Âë®„Çä„ÅÆËâ≤„Å´Ê∫∂„ÅëËæº„Çì„ÅßË¶ã„Åà„Å™„Åè„Åô„Çã„Åì„Å®„ÄÇËªçÈöä„ÅÆËø∑ÂΩ©Êúç„ÇÇ„Åì„Çå„ÅåË™ûÊ∫ê„Åß„Åô„ÄÇ" },
        { word: "antennae", phonetic: "[√¶nt√©niÀê]", translation: "Ëß¶Ëßí", meaning: "È†≠„Å´„Å§„ÅÑ„Å¶„ÅÑ„Çã„Ç¢„É≥„ÉÜ„Éä„ÄÇ„Åì„Çå„ÅßÂåÇ„ÅÑ„ÇíÂóÖ„ÅÑ„Å†„Çä„ÄÅÁâ©„Å´Ëß¶„Çå„Åü„Çä„Åó„Å¶Âë®„Çä„ÅÆÁä∂Ê≥Å„ÇíÊé¢„Çä„Åæ„Åô„ÄÇ" },

        // Image 4: Insects II
        { word: "pollinator", phonetic: "[p…ëÃÅl…ône√¨t…ôr]", translation: "Ëä±Á≤âÂ™í‰ªãËÄÖ", meaning: "„Éü„ÉÑ„Éê„ÉÅ„ÅÆ„Çà„ÅÜ„Å´„ÄÅËä±„Åã„ÇâËä±„Å∏È£õ„Å≥Âõû„Å£„Å¶Ëä±Á≤â„ÇíÈÅã„Çì„Åß„Åè„Çå„Çã„ÄåÊ§çÁâ©„ÅÆ„Ç≠„É•„Éº„Éî„ÉÉ„Éâ„ÄçÂΩπ„ÅÆÁîü„ÅçÁâ©„ÄÇ" },
        { word: "nectar", phonetic: "[n√©kt…ôr]", translation: "Ëä±Ëúú", meaning: "Ëä±„ÅåËô´„Çí„Åä„Å≥„ÅçÂØÑ„Åõ„Çã„Åü„ÇÅ„Å´Áî®ÊÑè„Åó„Åü„ÄÅ„ÅÇ„Åæ„Äú„ÅÑ„Ç∏„É•„Éº„Çπ„ÄÇ" },
        { word: "exoskeleton", phonetic: "[√®ksousk√©l…ôtn]", translation: "Â§ñÈ™®Ê†º", meaning: "ÊòÜËô´„ÇÑ„Ç´„Éã„ÅåÊåÅ„Å£„Å¶„ÅÑ„Çã„ÄåÈéßÔºà„Çà„Çç„ÅÑÔºâ„Äç„ÄÇ‰∫∫Èñì„ÅØÈ™®„Åå‰∏≠„Å´„ÅÇ„Çã„Åë„Å©„ÄÅÂΩº„Çâ„ÅØÈ™®ÔºàÊÆªÔºâ„ÇíÂ§ñÂÅ¥„Å´ÁùÄ„Å¶„ÅÑ„Åæ„Åô„ÄÇ" },
        { word: "pheromone", phonetic: "[f√©r…ôm√≤un]", translation: "„Éï„Çß„É≠„É¢„É≥", meaning: "‰ª≤ÈñìÂêåÂ£´„Åß‰ºöË©±„Åô„Çã„Åü„ÇÅ„ÅÆ„ÄåÂåÇ„ÅÑ„ÅÆÊâãÁ¥ô„Äç„ÄÇ„Åì„Çå„Åß„Äå„Åì„Å£„Å°„Å´È§å„Åå„ÅÇ„Çã„ÇàÔºÅ„Äç„Å®„Åã„ÄåÊïµ„ÅåÊù•„ÅüÔºÅ„Äç„Å®‰ºù„Åà„Åæ„Åô„ÄÇ" },
        { word: "bioluminescence", phonetic: "[b√†ioul√πÀêm…ôn√©sns]", translation: "ÁîüÁâ©Áô∫ÂÖâ", meaning: "„Éõ„Çø„É´„ÅÆ„Çà„ÅÜ„Å´„ÄÅÁîü„ÅçÁâ©„ÅåËá™ÂàÜ„ÅßÂÖâ„ÇäËºù„Åè„Åì„Å®„ÄÇ„É≠„Éû„É≥„ÉÅ„ÉÉ„ÇØ„Å™„Ç§„É´„Éü„Éç„Éº„Ç∑„Éß„É≥„Åß„Åô„ÄÇ" },
        { word: "swarm", phonetic: "[sw…îÀêrm]", translation: "ÔºàËô´„ÅÆÔºâÂ§ßÁæ§", meaning: "„Éè„ÉÅ„ÇÑ„Ç§„Éä„Ç¥„Å™„Å©„ÅåÂ§ßÈáè„Å´ÈõÜ„Åæ„Å£„Å¶„Éñ„É≥„Éñ„É≥È£õ„Å≥Âõû„Å£„Å¶„ÅÑ„ÇãÁä∂ÊÖã„ÄÇ„Å°„Çá„Å£„Å®ÊÄñ„ÅÑÈõÜÂõ£„Åß„Åô„ÄÇ" },
        { word: "social insect", phonetic: "[s√≥u É…ôl √≠ns√®kt]", translation: "Á§æ‰ºöÊÄßÊòÜËô´", meaning: "„Ç¢„É™„ÇÑ„Éè„ÉÅ„ÅÆ„Çà„ÅÜ„Å´„ÄÅÂ•≥Áéã„ÄÅÂÉç„ÅçÊâã„ÄÅÂÖµÈöä„Å®„ÅÑ„Å£„ÅüÂΩπÂâ≤ÂàÜÊãÖ„Çí„Åó„Å¶„ÄÅ„ÉÅ„Éº„É†„ÅßÁîüÊ¥ª„Åô„ÇãÊòÜËô´„ÅÆ„Åì„Å®„ÄÇ" },
        { word: "hive", phonetic: "[haiv]", translation: "„Éü„ÉÑ„Éê„ÉÅ„ÅÆÂ∑£", meaning: "„Åü„Åè„Åï„Çì„ÅÆ„Éè„ÉÅ„Åå‰∏ÄÁ∑í„Å´‰Ωè„Çì„Åß„ÅÑ„ÇãÂÆ∂„ÄÇ‰∏≠„ÅØÂÖ≠ËßíÂΩ¢„ÅÆÈÉ®Â±ã„Åå„ÅÑ„Å£„Å±„ÅÑ„ÅÇ„Çä„Åæ„Åô„ÄÇ" }
    ];

    /* =========================================
       2. State & Logic
       ========================================= */
    
    // Shuffle helper
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Deep copy to create a working list
    let studyList = shuffle([...rawData]);
    let currentCardIndex = 0;
    
    // DOM Elements
    const cardScene = document.getElementById('cardScene');
    const card = document.getElementById('card');
    const wordDisplay = document.getElementById('wordDisplay');
    const phoneticDisplay = document.getElementById('phoneticDisplay');
    const translationDisplay = document.getElementById('translationDisplay');
    const meaningDisplay = document.getElementById('meaningDisplay');
    const speakerBtn = document.getElementById('speakerBtn');
    
    const btnNg = document.getElementById('btnNg');
    const btnOk = document.getElementById('btnOk');
    const controls = document.getElementById('controls');
    
    const progressContainer = document.getElementById('progressContainer');
    const remainingCount = document.getElementById('remainingCount');
    const progressBar = document.getElementById('progressBar');
    
    const completionScreen = document.getElementById('completionScreen');

    /* =========================================
       3. Functions
       ========================================= */

    function updateProgress() {
        const total = rawData.length;
        const current = studyList.length;
        remainingCount.textContent = current;
        
        // Calculate progress based on how many are REMOVED (learned)
        const learned = total - current;
        const percentage = (learned / total) * 100;
        progressBar.style.width = `${percentage}%`;
    }

    function renderCard() {
        if (studyList.length === 0) {
            showCompletion();
            return;
        }

        // Reset Flip
        card.classList.remove('is-flipped');

        // Get current data
        // We always take the first item of the shuffled list or random pick
        // Here we stick to index 0 since we shuffle/rotate the array
        const data = studyList[0];

        // Slight delay to allow flip back animation if needed, but for instant feel:
        setTimeout(() => {
            wordDisplay.textContent = data.word;
            phoneticDisplay.textContent = data.phonetic;
            translationDisplay.textContent = data.translation;
            meaningDisplay.innerHTML = data.meaning; // Allow HTML tags if any
        }, 200);
        
        updateProgress();
    }

    function showCompletion() {
        cardScene.classList.add('hidden');
        controls.classList.add('hidden');
        progressContainer.classList.add('hidden');
        completionScreen.style.display = 'flex';
    }

    // --- Audio Logic ---
    function speakWord() {
        if (studyList.length === 0) return;
        
        const text = studyList[0].word;
        const utterance = new SpeechSynthesisUtterance(text);
        
        // Voice Selection Logic
        const voices = window.speechSynthesis.getVoices();
        
        // Priority: Google US English > Samantha > other en-US > en-GB
        let selectedVoice = voices.find(v => v.name === 'Google US English');
        if (!selectedVoice) {
            selectedVoice = voices.find(v => v.name === 'Samantha');
        }
        if (!selectedVoice) {
            selectedVoice = voices.find(v => v.lang === 'en-US');
        }
        if (!selectedVoice) {
            selectedVoice = voices.find(v => v.lang.startsWith('en'));
        }

        if (selectedVoice) {
            utterance.voice = selectedVoice;
        }
        
        utterance.rate = 0.9; // Slightly slower for clarity
        window.speechSynthesis.speak(utterance);
    }

    // Ensure voices are loaded (Chrome quirk)
    window.speechSynthesis.onvoiceschanged = () => {
        // Just triggers voice loading
    };

    /* =========================================
       4. Event Listeners
       ========================================= */

    // Flip Card
    cardScene.addEventListener('click', () => {
        card.classList.toggle('is-flipped');
    });

    // Speak Button (Stop propagation to prevent flip)
    speakerBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        speakWord();
    });

    // Button: NG (Rotates to end of queue)
    btnNg.addEventListener('click', (e) => {
        e.stopPropagation();
        
        // Animation feedback? Maybe later.
        // Move current item to the end of the list
        const currentItem = studyList.shift();
        studyList.push(currentItem);
        
        // Re-render
        renderCard();
    });

    // Button: OK (Removes from list)
    btnOk.addEventListener('click', (e) => {
        e.stopPropagation();
        
        // Remove current item
        studyList.shift();
        
        // Check if done
        renderCard();
    });

    /* =========================================
       5. Initialization
       ========================================= */
    // Initial Render
    renderCard();

</script>
</body>
</html>