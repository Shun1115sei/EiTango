<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç‰©å­¦ è‹±å˜èªï¼ˆå­¦ç¿’æ©Ÿèƒ½ä»˜ãï¼‰</title>
    <style>
        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #f0f4f8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        h1 {
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .status-bar {
            margin-bottom: 15px;
            font-size: 1rem;
            color: #555;
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .card-container {
            width: 90%;
            max-width: 500px;
            height: 400px;
            perspective: 1000px;
            cursor: pointer;
            margin-bottom: 20px;
            position: relative;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s cubic-bezier(0.4, 0.2, 0.2, 1);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-radius: 15px;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
            background: white;
            border: 1px solid #e1e8ed;
            padding: 20px;
        }

        .card-front {
            justify-content: center;
            background: linear-gradient(135deg, #ffffff 0%, #f7f9fc 100%);
            z-index: 2;
        }

        .card-back {
            transform: rotateY(180deg);
            justify-content: flex-start;
            padding-top: 40px;
            overflow-y: auto;
            background: #fff;
        }

        .word {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 5px;
        }

        .phonetic {
            font-size: 1.2rem;
            color: #7f8c8d;
            font-family: "Lucida Sans Unicode", "Arial Unicode MS", sans-serif;
            margin-bottom: 20px;
            background-color: #edf2f7;
            padding: 4px 12px;
            border-radius: 10px;
        }

        .btn-audio {
            background-color: #fff;
            border: 2px solid #3498db;
            color: #3498db;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 10px;
            z-index: 10;
        }

        .btn-audio:hover {
            background-color: #3498db;
            color: white;
            transform: scale(1.1);
        }

        .click-hint {
            position: absolute;
            bottom: 15px;
            font-size: 0.8rem;
            color: #bdc3c7;
        }

        .translation {
            font-size: 1.8rem;
            font-weight: bold;
            color: #e67e22;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #fce4cc;
            padding-bottom: 10px;
            width: 100%;
        }

        .meaning {
            font-size: 1.05rem;
            line-height: 1.8;
            color: #444;
            background: #fff8e1;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            text-align: left;
        }

        /* åˆ¤å®šãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
        .grading-controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            width: 90%;
            max-width: 500px;
        }

        .btn-grade {
            flex: 1;
            padding: 15px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.15);
        }

        .btn-grade:active {
            transform: scale(0.98);
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }

        /* è¦šãˆãŸãƒœã‚¿ãƒ³ */
        .btn-known {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        .btn-known span { font-size: 0.8rem; opacity: 0.9; }

        /* ã¾ã ãƒœã‚¿ãƒ³ */
        .btn-unknown {
            background: linear-gradient(135deg, #f39c12, #d35400);
        }
        .btn-unknown span { font-size: 0.8rem; opacity: 0.9; }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå°ã•ã„ãƒœã‚¿ãƒ³ï¼‰ */
        .nav-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        button.nav-btn {
            padding: 8px 15px;
            font-size: 0.9rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            background-color: #ecf0f1;
            color: #7f8c8d;
            transition: all 0.2s;
        }

        button.nav-btn:hover {
            background-color: #bdc3c7;
            color: #2c3e50;
        }

        /* å®Œäº†ç”»é¢ */
        .completed-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.95);
            display: none; /* åˆæœŸã¯éè¡¨ç¤º */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            border-radius: 15px;
        }

        .completed-overlay h2 {
            color: #27ae60;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .btn-restart {
            padding: 15px 30px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4);
        }
        
        .btn-restart:hover {
            background-color: #2980b9;
        }

    </style>
</head>
<body>

    <h1>ç”Ÿç‰©å­¦ è‹±å˜èªå¸³</h1>
    
    <div class="status-bar" id="status-bar">
        æ®‹ã‚Šæšæ•°: <strong id="remaining-count">50</strong> æš
    </div>

    <div class="card-container">
        <!-- å®Œäº†ç”»é¢ -->
        <div class="completed-overlay" id="completed-overlay">
            <h2>ğŸ‰ ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆï¼</h2>
            <p>å…¨ã¦ã®å˜èªã‚’è¦šãˆã¾ã—ãŸã€‚</p>
            <br>
            <button class="btn-restart" onclick="resetAll()">æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
        </div>

        <!-- ã‚«ãƒ¼ãƒ‰æœ¬ä½“ -->
        <div class="card" id="flashcard" onclick="flipCard()">
            <!-- è¡¨é¢ -->
            <div class="card-face card-front">
                <div class="word" id="word">mammal</div>
                <div class="phonetic" id="phonetic">/ËˆmÃ¦m.É™l/</div>
                
                <div class="btn-audio" onclick="playAudio(event)" title="ç™ºéŸ³ã‚’èã">ğŸ”Š</div>

                <div class="click-hint">ã‚¯ãƒªãƒƒã‚¯ã—ã¦è£é¢ã¸</div>
            </div>
            <!-- è£é¢ -->
            <div class="card-face card-back">
                <div class="translation" id="translation">å“ºä¹³é¡</div>
                <div class="meaning" id="meaning">
                    ãŠæ¯ã•ã‚“ã®ãŠä¹³ã‚’é£²ã‚“ã§è‚²ã¤å‹•ç‰©ã€‚<br>äººé–“ã€çŠ¬ã€çŒ«ãªã©ã€‚
                </div>
            </div>
        </div>
    </div>

    <!-- åˆ¤å®šãƒœã‚¿ãƒ³ -->
    <div class="grading-controls">
        <button class="btn-grade btn-unknown" onclick="markUnknown(event)">
            ğŸ”„ ã¾ã  / è‹¦æ‰‹
            <span>(ãƒªã‚¹ãƒˆã«æ®‹ã™)</span>
        </button>
        <button class="btn-grade btn-known" onclick="markKnown(event)">
            âœ… è¦šãˆãŸ
            <span>(ãƒªã‚¹ãƒˆã‹ã‚‰æ¶ˆã™)</span>
        </button>
    </div>

    <!-- è£œåŠ©ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div class="nav-controls">
        <button class="nav-btn" onclick="prevCard(event)">â† å‰ã«æˆ»ã‚‹</button>
        <button class="nav-btn" onclick="shuffleCards(event)">ğŸ”€ ã‚·ãƒ£ãƒƒãƒ•ãƒ«</button>
        <button class="nav-btn" onclick="resetAll()">ğŸ”„ å…¨ã¦ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <script>
        // å…¨ãƒ‡ãƒ¼ã‚¿ã®ãƒã‚¹ã‚¿ãƒ¼
        const allVocabulary = [
            { word: "mammal", phonetic: "/ËˆmÃ¦m.É™l/", translation: "å“ºä¹³é¡", meaning: "ãŠæ¯ã•ã‚“ã®ãŠä¹³ã‚’é£²ã‚“ã§è‚²ã¤å‹•ç‰©ã€‚<br>ï¼ˆäººé–“ã€çŠ¬ã€çŒ«ãªã©ï¼‰" },
            { word: "cetacean", phonetic: "/sÉªËˆteÉª.ÊƒÉ™n/", translation: "ã‚¯ã‚¸ãƒ©ç›®ã®å‹•ç‰©", meaning: "æµ·ã«ä½ã‚€å“ºä¹³é¡ã€‚<br>ï¼ˆã‚¯ã‚¸ãƒ©ã‚„ã‚¤ãƒ«ã‚«ã®ä»²é–“ï¼‰" },
            { word: "ruminant", phonetic: "/ËˆruË.mÉ™.nÉ™nt/", translation: "åèŠ»ï¼ˆã¯ã‚“ã™ã†ï¼‰å‹•ç‰©", meaning: "é£Ÿã¹ãŸè‰ã‚’èƒƒã‹ã‚‰å£ã«æˆ»ã—ã¦ã€ã‚‚ã†ä¸€åº¦å™›ã‚€å‹•ç‰©ã€‚<br>ï¼ˆã‚¦ã‚·ã€ãƒ’ãƒ„ã‚¸ã€ã‚­ãƒªãƒ³ãªã©ï¼‰" },
            { word: "tusk", phonetic: "/tÊŒsk/", translation: "ç‰™ï¼ˆãã°ï¼‰", meaning: "å£ã‹ã‚‰çªãå‡ºã—ãŸé•·ã„æ­¯ã€‚<br>ï¼ˆã‚¾ã‚¦ã‚„ã‚¤ãƒã‚·ã‚·ãªã©ï¼‰" },
            { word: "avian", phonetic: "/ËˆeÉª.vi.É™n/", translation: "é³¥é¡ã®", meaning: "ã€Œãƒãƒ¼ãƒ‰(Bird)ã€ã®å­¦è¡“ç”¨èªã€‚<br>é³¥ã«é–¢ã™ã‚‹ã“ã¨ã€‚" },
            { word: "plumage", phonetic: "/ËˆpluË.mÉªdÊ’/", translation: "ï¼ˆé³¥ã®ï¼‰ç¾½ã€ç¾½æ¯›", meaning: "é³¥ã®ä½“ã‚’è¦†ã£ã¦ã„ã‚‹ç¾½ã®å…¨ä½“ã®ã“ã¨ã€‚" },
            { word: "reptile", phonetic: "/Ëˆrep.taÉªl/", translation: "çˆ¬è™«é¡", meaning: "ã‚¦ãƒ­ã‚³ãŒã‚ã‚Šã€åµã‚’ç”£ã‚€å¤‰æ¸©å‹•ç‰©ã€‚<br>ï¼ˆãƒ˜ãƒ“ã€ãƒˆã‚«ã‚²ã€ãƒ¯ãƒ‹ãªã©ï¼‰" },
            { word: "venom", phonetic: "/Ëˆven.É™m/", translation: "ï¼ˆãƒ˜ãƒ“ãªã©ã®ï¼‰æ¯’", meaning: "å™›ã¿ä»˜ã„ã¦ç›¸æ‰‹ã«æ³¨å…¥ã™ã‚‹ã‚¿ã‚¤ãƒ—ã®æ¯’ã€‚" },
            { word: "amphibian", phonetic: "/Ã¦mËˆfÉªb.i.É™n/", translation: "ä¸¡ç”Ÿé¡", meaning: "å­ä¾›ã¯æ°´ã®ä¸­ã€å¤§äººã¯é™¸ã§æš®ã‚‰ã™å‹•ç‰©ã€‚<br>ï¼ˆã‚«ã‚¨ãƒ«ã€ã‚¤ãƒ¢ãƒªãªã©ï¼‰" },
            { word: "gill", phonetic: "/É¡Éªl/", translation: "ï¼ˆé­šã®ï¼‰ãˆã‚‰", meaning: "æ°´ã®ä¸­ã§å‘¼å¸ã™ã‚‹ãŸã‚ã®å™¨å®˜ã€‚" },
            { word: "fin", phonetic: "/fÉªn/", translation: "ï¼ˆé­šã®ï¼‰ã²ã‚Œ", meaning: "æ³³ãã¨ãã«ä½¿ã†ã€é­šã®æ‰‹è¶³ã®ã‚ˆã†ãªéƒ¨åˆ†ã€‚" },
            { word: "rodent", phonetic: "/ËˆroÊŠ.dÉ™nt/", translation: "é½§æ­¯é¡ï¼ˆã’ã£ã—ã‚‹ã„ï¼‰", meaning: "å‰æ­¯ã§ç‰©ã‚’ã‹ã˜ã‚‹ã®ãŒå¾—æ„ãªå‹•ç‰©ã€‚<br>ï¼ˆãƒã‚ºãƒŸã€ãƒªã‚¹ã€ãƒ“ãƒ¼ãƒãƒ¼ãªã©ï¼‰" },
            { word: "invertebrate", phonetic: "/ÉªnËˆvÉË.tÌ¬É™.brÉ™t/", translation: "ç„¡è„Šæ¤å‹•ç‰©", meaning: "èƒŒéª¨ãŒãªã„å‹•ç‰©ã€‚<br>ï¼ˆè™«ã€ã‚¿ã‚³ã€ã‚«ãƒ‹ã€è²ãªã©ï¼‰" },
            { word: "arthropod", phonetic: "/ËˆÉ‘Ër.Î¸rÉ™.pÉ‘Ëd/", translation: "ç¯€è¶³å‹•ç‰©", meaning: "ä½“ãŒæ®»ã§è¦†ã‚ã‚Œã¦ã„ã¦ã€è¶³ã«é–¢ç¯€ãŒã‚ã‚‹å‹•ç‰©ã€‚<br>ï¼ˆæ˜†è™«ã€ã‚¯ãƒ¢ã€ã‚¨ãƒ“ã€ã‚«ãƒ‹ï¼‰" },
            { word: "mollusk", phonetic: "/ËˆmÉ‘Ë.lÉ™sk/", translation: "è»Ÿä½“å‹•ç‰©", meaning: "ä½“ãŒæŸ”ã‚‰ã‹ã„å‹•ç‰©ã€‚<br>ï¼ˆã‚¿ã‚³ã€ã‚¤ã‚«ã€è²ã€ã‚«ã‚¿ãƒ„ãƒ ãƒªï¼‰" },
            { word: "bivalve", phonetic: "/ËˆbaÉª.vÃ¦lv/", translation: "äºŒæšè²", meaning: "2æšã®æ®»ã§æŒŸã¾ã£ã¦ã„ã‚‹è²ã€‚<br>ï¼ˆã‚¢ã‚µãƒªã€ãƒ›ã‚¿ãƒ†ã€ã‚«ã‚­ãªã©ï¼‰" },
            { word: "mate", phonetic: "/meÉªt/", translation: "ï¼ˆå‹•ç‰©ã®ï¼‰ã¤ãŒã„", meaning: "ç¹æ®–ã®ãŸã‚ã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ï¼ˆå¤«ã‚„å¦»ï¼‰ã€‚" },
            { word: "courtship", phonetic: "/ËˆkÉ”Ërt.ÊƒÉªp/", translation: "æ±‚æ„›è¡Œå‹•", meaning: "ã‚ªã‚¹ãŒãƒ¡ã‚¹ã«ã€Œå¥½ãã§ã™ã€ã¨ã‚¢ãƒ”ãƒ¼ãƒ«ã™ã‚‹è¡Œå‹•ã€‚<br>ï¼ˆãƒ€ãƒ³ã‚¹ã‚„é³´ãå£°ãªã©ï¼‰" },
            { word: "breed", phonetic: "/briËd/", translation: "ç¹æ®–ã™ã‚‹", meaning: "å­ä¾›ã‚’ä½œã£ã¦å¢—ãˆã‚‹ã“ã¨ã€‚<br>ï¼ˆåè©ã ã¨ã€ŒçŠ¬ç¨®ã€ãªã©ã®å“ç¨®ï¼‰" },
            { word: "fertilization", phonetic: "/ËŒfÉË.tÌ¬É™l.É™ËˆzeÉª.ÊƒÉ™n/", translation: "å—ç²¾", meaning: "åµå­ã¨ç²¾å­ãŒãã£ã¤ãã“ã¨ã€‚" },
            { word: "hatchling", phonetic: "/ËˆhÃ¦tÊƒ.lÉªÅ‹/", translation: "å­µåŒ–ã—ãŸã¦ã®ãƒ’ãƒŠ", meaning: "åµã‹ã‚‰ç”Ÿã¾ã‚ŒãŸã°ã‹ã‚Šã®èµ¤ã¡ã‚ƒã‚“ã€‚" },
            { word: "feeding habit", phonetic: "/ËˆfiË.dÉªÅ‹ ËˆhÃ¦b.Éªt/", translation: "é£Ÿæ€§ï¼ˆã—ã‚‡ãã›ã„ï¼‰", meaning: "ã€Œä½•ã‚’é£Ÿã¹ã‚‹ã‹ã€ã¨ã„ã†ç¿’æ…£ã€‚" },
            { word: "scavenger", phonetic: "/ËˆskÃ¦v.Éªn.dÊ’Éš/", translation: "è…è‚‰é£Ÿå‹•ç‰©", meaning: "æ­»ã‚“ã å‹•ç‰©ã®è‚‰ã‚’æ¢ã—ã¦é£Ÿã¹ã‚‹ã€ŒãŠæƒé™¤å±‹ã€å‹•ç‰©ã€‚<br>ï¼ˆãƒã‚¤ã‚¨ãƒŠã‚„ãƒã‚²ãƒ¯ã‚·ãªã©ï¼‰" },
            { word: "prey", phonetic: "/preÉª/", translation: "ç²ç‰©", meaning: "ä»–ã®å‹•ç‰©ã«é£Ÿã¹ã‚‰ã‚Œã¦ã—ã¾ã†å´ã®å‹•ç‰©ã€‚" },
            { word: "bottom feeder", phonetic: "/ËˆbÉ‘Ë.tÌ¬É™m ËŒfiË.dÉš/", translation: "åº•ç”Ÿç”Ÿç‰©", meaning: "æ°´åº•ï¼ˆæµ·ã®åº•ãªã©ï¼‰ã«ã‚ã‚‹ã‚¨ã‚µã‚’é£Ÿã¹ã‚‹é­šã‚„ã‚¨ãƒ“ã€‚" },
            { word: "endotherm", phonetic: "/Ëˆen.doÊŠ.Î¸ÉËm/", translation: "æ’æ¸©å‹•ç‰©", meaning: "å‘¨ã‚Šã®æ°—æ¸©ã«é–¢ä¿‚ãªãã€ä½“æ¸©ã‚’ä¸€å®šã«ä¿ã¦ã‚‹å‹•ç‰©ã€‚<br>ï¼ˆå“ºä¹³é¡ãƒ»é³¥é¡ï¼‰" },
            { word: "hibernation", phonetic: "/ËŒhaÉª.bÉšËˆneÉª.ÊƒÉ™n/", translation: "å†¬çœ ", meaning: "å†¬ã®é–“ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ä½¿ã‚ãªã„ã‚ˆã†ã«çœ ã£ã¦éã”ã™ã“ã¨ã€‚" },
            { word: "migration", phonetic: "/maÉªËˆÉ¡reÉª.ÊƒÉ™n/", translation: "ï¼ˆæ¸¡ã‚Šé³¥ã®ï¼‰ç§»å‹•", meaning: "å­£ç¯€ã”ã¨ã«å ´æ‰€ã‚’å¤§ããç§»å‹•ã™ã‚‹ã“ã¨ã€‚" },
            { word: "vocalization", phonetic: "/ËŒvoÊŠ.kÉ™l.É™ËˆzeÉª.ÊƒÉ™n/", translation: "ç™ºå£°", meaning: "é³´ãå£°ã‚’å‡ºã—ã¦ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¨ã‚‹ã“ã¨ã€‚" },
            { word: "echolocation", phonetic: "/ËŒek.oÊŠ.loÊŠËˆkeÉª.ÊƒÉ™n/", translation: "åéŸ¿å®šä½", meaning: "éŸ³æ³¢ã‚’å‡ºã—ã¦ã€ãã®è·³ã­è¿”ã‚Šã§ç‰©ã®ä½ç½®ã‚’çŸ¥ã‚‹èƒ½åŠ›ã€‚<br>ï¼ˆã‚³ã‚¦ãƒ¢ãƒªã‚„ã‚¤ãƒ«ã‚«ï¼‰" },
            { word: "botany", phonetic: "/ËˆbÉ‘Ë.tÌ¬É™n.i/", translation: "æ¤ç‰©å­¦", meaning: "æ¤ç‰©ã«ã¤ã„ã¦ç ”ç©¶ã™ã‚‹å­¦å•ã€‚" },
            { word: "seed", phonetic: "/siËd/", translation: "ç¨®ï¼ˆãŸã­ï¼‰", meaning: "æ¤ç‰©ã®èµ¤ã¡ã‚ƒã‚“ã€‚" },
            { word: "spore", phonetic: "/spÉ”Ër/", translation: "èƒå­ï¼ˆã»ã†ã—ï¼‰", meaning: "ã‚­ãƒã‚³ã‚„ã‚·ãƒ€æ¤ç‰©ãŒå¢—ãˆã‚‹ãŸã‚ã®ç²‰ã€‚<br>ï¼ˆç¨®ã¿ãŸã„ãªå½¹å‰²ï¼‰" },
            { word: "germination", phonetic: "/ËŒdÊ’ÉË.mÉ™ËˆneÉª.ÊƒÉ™n/", translation: "ç™ºèŠ½", meaning: "ç¨®ã‹ã‚‰èŠ½ãŒå‡ºã‚‹ã“ã¨ã€‚" },
            { word: "pollen", phonetic: "/ËˆpÉ‘Ë.lÉ™n/", translation: "èŠ±ç²‰", meaning: "èŠ±ã®é›„ã—ã¹ã‹ã‚‰å‡ºã‚‹ç²‰ã€‚" },
            { word: "photosynthesis", phonetic: "/ËŒfoÊŠ.tÌ¬oÊŠËˆsÉªn.Î¸É™.sÉªs/", translation: "å…‰åˆæˆ", meaning: "æ¤ç‰©ãŒå…‰ã‚’æµ´ã³ã¦ã€æ „é¤Šï¼ˆãƒ‡ãƒ³ãƒ—ãƒ³ï¼‰ã‚’ä½œã‚‹ã“ã¨ã€‚" },
            { word: "chlorophyll", phonetic: "/ËˆklÉ”Ër.É™.fÉªl/", translation: "è‘‰ç·‘ç´ ", meaning: "æ¤ç‰©ãŒç·‘è‰²ã«è¦‹ãˆã‚‹ç†ç”±ã®æˆåˆ†ã€‚<br>å…‰åˆæˆã«å¿…è¦ã€‚" },
            { word: "cellulose", phonetic: "/Ëˆsel.ju.loÊŠs/", translation: "ã‚»ãƒ«ãƒ­ãƒ¼ã‚¹", meaning: "æ¤ç‰©ã®ç´°èƒã‚’æ”¯ãˆã¦ã„ã‚‹ç¹Šç¶­ã€‚<br>ç´™ã®åŸæ–™ã«ãªã‚‹ã€‚" },
            { word: "stem", phonetic: "/stem/", translation: "èŒã€å¹¹", meaning: "æ¤ç‰©ã®ä½“ã‚’æ”¯ãˆã‚‹æ£’çŠ¶ã®éƒ¨åˆ†ã€‚" },
            { word: "petal", phonetic: "/Ëˆpet.Ì¬É™l/", translation: "èŠ±ã³ã‚‰", meaning: "èŠ±ã®è‰²ãŒã¤ã„ã¦ã„ã‚‹ãƒ’ãƒ©ãƒ’ãƒ©ã—ãŸéƒ¨åˆ†ã€‚" },
            { word: "stoma", phonetic: "/ËˆstoÊŠ.mÉ™/", translation: "æ°—å­”ï¼ˆãã“ã†ï¼‰", meaning: "è‘‰ã£ã±ã®è£ã«ã‚ã‚‹ã€å‘¼å¸ã™ã‚‹ãŸã‚ã®å°ã•ãªç©´ã€‚" },
            { word: "vein", phonetic: "/veÉªn/", translation: "è‘‰è„ˆ / é™è„ˆ", meaning: "è‘‰ã£ã±ã®ç­‹ï¼ˆã™ã˜ï¼‰ã€‚æ „é¤Šã‚„æ°´ã®é€šã‚Šé“ã€‚<br>ï¼ˆå‹•ç‰©ã®å ´åˆã¯è¡€ç®¡ï¼‰" },
            { word: "taproot", phonetic: "/ËˆtÃ¦p.ruËt/", translation: "ä¸»æ ¹ï¼ˆã—ã‚…ã“ã‚“ï¼‰", meaning: "åœ°é¢æ·±ãã«ä¼¸ã³ã‚‹ã€å¤ªãã¦ãƒ¡ã‚¤ãƒ³ã®æ ¹ã£ã“ã€‚" },
            { word: "perennial", phonetic: "/pÉ™Ëˆren.i.É™l/", translation: "å¤šå¹´ç”Ÿæ¤ç‰©", meaning: "2å¹´ä»¥ä¸Šç”Ÿãç¶šã‘ã‚‹æ¤ç‰©ã€‚" },
            { word: "annual", phonetic: "/ËˆÃ¦n.ju.É™l/", translation: "ä¸€å¹´ç”Ÿæ¤ç‰©", meaning: "1å¹´ä»¥å†…ã«æ¯ã‚Œã‚‹æ¤ç‰©ã€‚" },
            { word: "biennial", phonetic: "/baÉªËˆen.i.É™l/", translation: "äºŒå¹´ç”Ÿæ¤ç‰©", meaning: "2å¹´ã‹ã‘ã¦æˆé•·ã™ã‚‹æ¤ç‰©ã€‚" },
            { word: "vegetation", phonetic: "/ËŒvedÊ’.É™ËˆteÉª.ÊƒÉ™n/", translation: "æ¤ç”Ÿï¼ˆã—ã‚‡ãã›ã„ï¼‰", meaning: "ã‚ã‚‹å ´æ‰€ã«ç”Ÿãˆã¦ã„ã‚‹æ¤ç‰©ã®é›†ã¾ã‚Šã€‚" },
            { word: "cluster", phonetic: "/ËˆklÊŒs.tÉš/", translation: "ï¼ˆå®Ÿãªã©ã®ï¼‰æˆ¿", meaning: "ãƒ–ãƒ‰ã‚¦ã®æˆ¿ã®ã‚ˆã†ã«ã€å¯†é›†ã—ã¦ã„ã‚‹çŠ¶æ…‹ã€‚" },
            { word: "clump", phonetic: "/klÊŒmp/", translation: "èŒ‚ã¿ã€ç¾¤ã‚Œ", meaning: "ã‚ã¡ã“ã¡ã«å›ºã¾ã£ã¦ç”Ÿãˆã¦ã„ã‚‹è‰æœ¨ã€‚" },
            { word: "scrubland", phonetic: "/ËˆskrÊŒb.lÃ¦nd/", translation: "ä½æœ¨åœ°å¸¯", meaning: "èƒŒã®ä½ã„æœ¨ã‚„è‰ã°ã‹ã‚ŠãŒç”Ÿãˆã¦ã„ã‚‹åœŸåœ°ã€‚" },
            { word: "canopy", phonetic: "/ËˆkÃ¦n.É™.pi/", translation: "æ¨¹å† ï¼ˆã˜ã‚…ã‹ã‚“ï¼‰", meaning: "æ£®ã®ä¸Šã®æ–¹ã§ã€æœ¨ã®æã‚„è‘‰ãŒå±‹æ ¹ã®ã‚ˆã†ã«è¦†ã£ã¦ã„ã‚‹éƒ¨åˆ†ã€‚" },
            { word: "forest understory", phonetic: "/ËˆfÉ”Ër.Éªst ËˆÊŒn.dÉšËŒstÉ”Ër.i/", translation: "æ—åºŠï¼ˆã‚Šã‚“ã—ã‚‡ã†ï¼‰", meaning: "æ£®ã®åœ°é¢ã«è¿‘ã„ã€è–„æš—ã„éƒ¨åˆ†ã€‚<br>ï¼ˆCanopyã®ä¸‹ï¼‰" },
            { word: "timberline", phonetic: "/ËˆtÉªm.bÉš.laÉªn/", translation: "æ£®æ—é™ç•Œ", meaning: "ã€Œã“ã‚Œã‚ˆã‚Šé«˜ã„å ´æ‰€ã«ã¯æœ¨ãŒç”Ÿãˆãªã„ã€ã¨ã„ã†å¢ƒç•Œç·šã€‚" },
            { word: "deciduous", phonetic: "/dÉªËˆsÉªdÊ’.u.É™s/", translation: "è½è‘‰æ€§ã®", meaning: "ç§‹ã«ãªã‚‹ã¨è‘‰ã£ã±ã‚’å…¨éƒ¨è½ã¨ã™æœ¨ã®ã“ã¨ã€‚<br>ï¼ˆâ‡” Evergreen å¸¸ç·‘æ¨¹ï¼‰" },
            { word: "shade-tolerant", phonetic: "/ÊƒeÉªd ËˆtÉ‘Ë.lÉš.É™nt/", translation: "è€é™°æ€§ã®ã‚ã‚‹", meaning: "æ—¥é™°ã§ã‚‚å…ƒæ°—ã«è‚²ã¤ã“ã¨ãŒã§ãã‚‹æ€§è³ªã€‚" },
            { word: "broad-leaved", phonetic: "/brÉ”Ëd liËvd/", translation: "åºƒè‘‰ã®", meaning: "è‘‰ã£ã±ãŒå¹³ã¹ã£ãŸãã¦åºƒã„æœ¨ã€‚<br>ï¼ˆã‚µã‚¯ãƒ©ãªã©ï¼‰" },
            { word: "conifer", phonetic: "/ËˆkÉ‘Ë.nÉ™.fÉš/", translation: "é‡è‘‰æ¨¹", meaning: "è‘‰ãŒé‡ã¿ãŸã„ã§ã€æ¾ã¼ã£ãã‚ŠãŒã§ãã‚‹æœ¨ã€‚<br>ï¼ˆãƒãƒ„ã‚„ã‚¹ã‚®ãªã©ï¼‰" },
            { word: "insectivorous plant", phonetic: "/ËŒÉªn.sekËˆtÉªv.Éš.É™s plÃ¦nt/", translation: "é£Ÿè™«æ¤ç‰©", meaning: "è™«ã‚’æ•ã¾ãˆã¦æ „é¤Šã«ã™ã‚‹æ¤ç‰©ã€‚" },
            { word: "alga", phonetic: "/ËˆÃ¦l.É¡É™/", translation: "è—»é¡ï¼ˆãã†ã‚‹ã„ï¼‰", meaning: "ãƒ¯ã‚«ãƒ¡ã‚„æµ·è‹”ã€æ°´æ§½ã®ã‚³ã‚±ãªã©ã®ä»²é–“ã€‚<br>ï¼ˆè¤‡æ•°å½¢ã¯ Algaeï¼‰" },
            { word: "arboreal", phonetic: "/É‘ËrËˆbÉ”Ër.i.É™l/", translation: "æ¨¹ä¸Šã®", meaning: "åœ°é¢ã§ã¯ãªãã€æœ¨ã®ä¸Šã§ç”Ÿæ´»ã™ã‚‹æ€§è³ªã€‚" }
        ];

        // å­¦ç¿’ç”¨ãƒ‡ãƒƒã‚­ï¼ˆæœ€åˆã¯å…¨å˜èªã®ã‚³ãƒ”ãƒ¼ï¼‰
        let studyDeck = [...allVocabulary];
        let currentIndex = 0;
        let isFlipped = false;
        let preferredVoice = null;

        const cardElement = document.getElementById('flashcard');
        const wordElement = document.getElementById('word');
        const phoneticElement = document.getElementById('phonetic');
        const translationElement = document.getElementById('translation');
        const meaningElement = document.getElementById('meaning');
        const remainingCountElement = document.getElementById('remaining-count');
        const completedOverlay = document.getElementById('completed-overlay');
        const synth = window.speechSynthesis;

        // --- éŸ³å£°è¨­å®š ---
        function loadVoices() {
            const voices = synth.getVoices();
            preferredVoice = voices.find(voice => voice.name.includes("Google US English")) ||
                             voices.find(voice => voice.name.includes("Samantha")) || 
                             voices.find(voice => voice.name.includes("Zira")) ||
                             voices.find(voice => voice.lang === "en-US");
        }
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();

        // --- åˆæœŸåŒ– ---
        updateCard();

        function playAudio(event) {
            event.stopPropagation();
            if (synth.speaking) synth.cancel();
            
            // ãƒ‡ãƒƒã‚­ãŒç©ºã®æ™‚ã®ã‚¨ãƒ©ãƒ¼é˜²æ­¢
            if (studyDeck.length === 0) return;

            const item = studyDeck[currentIndex];
            const utterThis = new SpeechSynthesisUtterance(item.word);
            if (preferredVoice) utterThis.voice = preferredVoice;
            utterThis.lang = 'en-US';
            synth.speak(utterThis);
        }

        function flipCard() {
            if (studyDeck.length === 0) return;
            isFlipped = !isFlipped;
            if (isFlipped) {
                cardElement.classList.add('flipped');
            } else {
                cardElement.classList.remove('flipped');
            }
        }

        // --- å­¦ç¿’æ©Ÿèƒ½ã®ãƒ­ã‚¸ãƒƒã‚¯ ---

        // ã€Œè¦šãˆãŸã€ãƒœã‚¿ãƒ³ï¼šãƒ‡ãƒƒã‚­ã‹ã‚‰å‰Šé™¤
        function markKnown(event) {
            event.stopPropagation(); // ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯ã®ãƒ•ãƒªãƒƒãƒ—é˜²æ­¢
            if (studyDeck.length === 0) return;

            // è£è¿”ã—ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‹ã‚‰å‡¦ç†
            resetFlip(() => {
                // ç¾åœ¨ã®ã‚«ãƒ¼ãƒ‰ã‚’å‰Šé™¤
                studyDeck.splice(currentIndex, 1);
                
                // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹èª¿æ•´ï¼ˆæœ«å°¾ã‚’æ¶ˆã—ãŸå ´åˆã€0ã«æˆ»ã‚‹ï¼‰
                if (currentIndex >= studyDeck.length) {
                    currentIndex = 0;
                }
                
                updateCard();
            });
        }

        // ã€Œã¾ã ã€ãƒœã‚¿ãƒ³ï¼šãƒ‡ãƒƒã‚­ã«æ®‹ã—ã¦æ¬¡ã¸
        function markUnknown(event) {
            event.stopPropagation();
            if (studyDeck.length === 0) return;

            resetFlip(() => {
                // æ¬¡ã®ã‚«ãƒ¼ãƒ‰ã¸ï¼ˆå¾ªç’°ï¼‰
                currentIndex = (currentIndex + 1) % studyDeck.length;
                updateCard();
            });
        }

        // å˜ãªã‚‹é–²è¦§ç”¨ã€Œå‰ã¸ã€
        function prevCard(event) {
            event && event.stopPropagation();
            if (studyDeck.length === 0) return;
            resetFlip(() => {
                currentIndex = (currentIndex - 1 + studyDeck.length) % studyDeck.length;
                updateCard();
            });
        }

        // ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        function shuffleCards(event) {
            event && event.stopPropagation();
            if (studyDeck.length === 0) return;
            resetFlip(() => {
                for (let i = studyDeck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [studyDeck[i], studyDeck[j]] = [studyDeck[j], studyDeck[i]];
                }
                currentIndex = 0;
                updateCard();
            });
        }

        // å…¨ãƒªã‚»ãƒƒãƒˆ
        function resetAll() {
            studyDeck = [...allVocabulary];
            currentIndex = 0;
            isFlipped = false;
            cardElement.classList.remove('flipped');
            completedOverlay.style.display = 'none';
            updateCard();
        }

        function resetFlip(callback) {
            if (isFlipped) {
                isFlipped = false;
                cardElement.classList.remove('flipped');
                setTimeout(callback, 300);
            } else {
                callback();
            }
        }

        function updateCard() {
            // æ®‹ã‚Šæšæ•°æ›´æ–°
            remainingCountElement.textContent = studyDeck.length;

            // å®Œäº†åˆ¤å®š
            if (studyDeck.length === 0) {
                completedOverlay.style.display = 'flex';
                return;
            } else {
                completedOverlay.style.display = 'none';
            }

            const item = studyDeck[currentIndex];
            wordElement.textContent = item.word;
            phoneticElement.textContent = item.phonetic;
            translationElement.textContent = item.translation;
            meaningElement.innerHTML = item.meaning;
        }

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œå¯¾å¿œ
        document.addEventListener('keydown', (e) => {
            if (studyDeck.length === 0) return;

            if (e.code === 'Space' || e.code === 'Enter') {
                e.preventDefault();
                flipCard();
            } else if (e.code === 'ArrowRight') {
                // å³ã‚­ãƒ¼ã¯ã€Œã¾ã ã€ã¨åŒã˜æŒ™å‹•ï¼ˆæ¬¡ã¸ï¼‰
                markUnknown(e);
            } else if (e.code === 'ArrowLeft') {
                // å·¦ã‚­ãƒ¼ã¯ã€Œå‰ã¸ã€
                prevCard();
            } else if (e.code === 'ArrowUp') {
                // ä¸Šã‚­ãƒ¼ã§ã€Œè¦šãˆãŸã€
                markKnown(e);
            } else if (e.key === 'a' || e.key === 's') {
                playAudio({ stopPropagation: () => {} });
            }
        });
    </script>
</body>
</html>